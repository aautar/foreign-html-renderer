var ForeignHtmlRenderer=function(a){"use strict";const b={};b.ContentType={APPLICATION_JSON:"application/json"},b.convertBlobToString=function(a,b){const c=new FileReader;c.readAsText(a),c.onloadend=function(){b(c.result)}},b.parseXHRResponseData=function(a,c){if("undefined"==typeof a||null===a||0===a.size)return void c(a);if(a.type===b.ContentType.APPLICATION_JSON){var d={};b.convertBlobToString(a,function(a){d=JSON.parse(a),c(d)})}else"text"===a.type.split("/")[0]?b.convertBlobToString(a,function(a){c(a)}):c(a)},b.makeFormDataRequestData=function(a,b){return{body:a,headers:b||new Map}},b.makeJsonRequestData=function(a,c){return c=c||new Map,c.set("Content-Type",b.ContentType.APPLICATION_JSON),{body:JSON.stringify(a),headers:c}},b.makeBlobRequestData=function(a,b){return b=b||new Map,b.set("Content-Type",a.type),{body:a,headers:b}},b.makeUrlQueryString=function(a){const b=[];for(let[c,d]of a)b.push(`${c}=${encodeURIComponent(d)}`);return"?"+b.join("&")},b.xhr=function(a,c,d,e,f,g,h){const i=d.headers;e=e||(()=>{}),f=f||(()=>{}),g=g||(()=>{});const j=function(a,c){c?f(c,k):b.parseXHRResponseData(k.response,function(a){f(a,k)})},k=new XMLHttpRequest;k.open(a,c);for(let[b,j]of i)k.setRequestHeader(b,j);return k.responseType="blob",k.timeout=h&&h.timeout?h.timeout:3e4,k.onload=function(){400<=k.status?j():b.parseXHRResponseData(k.response,function(a){e(a,k)})},k.ontimeout=function(){j(k,"client timeout")},k.onerror=function(){j()},k.onloadend=function(){b.parseXHRResponseData(k.response,function(a){g(a,k)})},k.send(d.body),k},b.post=function(a,c,d,e,f){return b.xhr("POST",a,c,d,e,f)},b.put=function(a,c,d,e,f){return b.xhr("PUT",a,c,d,e,f)},b.delete=function(a,c,d,e,f){return b.xhr("DELETE",a,c,d,e,f)},b.get=function(a,c,d,e,f){return b.xhr("GET",a,{body:null,headers:c},d,e,f)},b.head=function(a,c,d,e,f){return b.xhr("HEAD",a,{body:null,headers:c},d,e,f)},b.postBeacon=function(a,b){return navigator.sendBeacon(a,b.body)};return a.ImageRenderer=function(a){const c=this,d=function(a){return new Promise(function(b){const c=new FileReader;c.readAsDataURL(a),c.onloadend=function(){b(c.result)}})},e=function(a){return new Promise(function(c,e){b.get(a,new Map,async(b,e)=>{if("Blob"!==e.response.constructor.name)c({resourceUrl:a,resourceBase64:null});else{const b=await d(e.response);c({resourceUrl:a,resourceBase64:b})}},()=>{e("xhr request failed")})})},f=function(a){const b=[];for(let c=0;c<a.length;c++)b.push(e(a[c]));return Promise.all(b)},g=function(a,b,c,d){const e=a.indexOf(c,b);if(-1===e)return null;let f="";for(let g=e+c.length;g<a.length&&-1===d.indexOf(a[g]);g++)f+=a[g];return{foundAtIndex:e,value:f}},h=function(a){const b=[];for(let c=0;;){const d=g(a,c,"url(",[")"]);if(null===d)break;c=d.foundAtIndex+d.value.length,b.push(j(d.value))}return b},i=function(a){const b=[];for(let c=0;;){const d=g(a,c,"src=",[" ",">","\t"]);if(null===d)break;c=d.foundAtIndex+d.value.length,b.push(j(d.value))}return b},j=function(a){return a.replace(/["']/g,"")},k=function(a){return a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},l=async function(b,c,e){return new Promise(async function(g){let l="",m=[];for(let b=0;b<a.length;b++){try{a[b].cssRules}catch(c){console.warn("Inaccessible stylesheet: "+a[b].href);continue}for(let c=0;c<a[b].cssRules.length;c++){const d=a[b].cssRules[c].cssText;m.push(...h(d)),l+=d}}const n=await f(m);for(let a=0;a<n.length;a++){const b=n[a];l=l.replace(new RegExp(k(b.resourceUrl),"g"),b.resourceBase64)}let o=i(b);const p=await f(o);for(let a=0;a<p.length;a++){const c=p[a];b=b.replace(new RegExp(k(c.resourceUrl),"g"),c.resourceBase64)}const q=document.createElement("style");q.innerHTML=l;const r=new XMLSerializer().serializeToString(q),s=document.createElement("div");s.innerHTML=r+b,s.setAttribute("xmlns","http://www.w3.org/1999/xhtml");const t=new XMLSerializer().serializeToString(s),u=new Blob([new TextEncoder().encode(`
                <svg xmlns='http://www.w3.org/2000/svg' width='${c}' height='${e}'>
                    <g transform='translate(0, 0) rotate(0)'>
                        <foreignObject x='0' y='0' width='${c}' height='${e}'>
                            ${t}
                        </foreignObject>
                    </g>
                </svg>`)],{type:"image/svg+xml;base64"}),v=await d(u);g(v)})};this.renderToImage=async function(a,b,c){return new Promise(async function(d){const e=new Image;e.src=await l(a,b,c),e.onload=function(){d(e)}})},this.renderToCanvas=async function(a,b,d){return new Promise(async function(e){const f=await c.renderToImage(a,b,d),g=document.createElement("canvas");g.width=f.width,g.height=f.height;const h=g.getContext("2d");h.drawImage(f,0,0,f.width,f.height),e(g)})},this.renderToBase64Png=async function(a,b,d){return new Promise(async function(e){const f=await c.renderToCanvas(a,b,d);e(f.toDataURL("image/png"))})}},Object.defineProperty(a,"__esModule",{value:!0}),a}({});
